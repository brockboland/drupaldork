<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta about="/2012/03/d6-garland-theme-batch-processing" property="sioc:num_replies" content="4" datatype="xsd:integer" />
<link rel="shortcut icon" href="../misc/favicon.ico" type="image/vnd.microsoft.icon" />
<meta content="D6: Garland Theme for Batch Processing" about="/2012/03/d6-garland-theme-batch-processing" property="dc:title" />
<link rel="shortlink" href="../2012/03/d6-garland-theme-batch-processing.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="../2012/03/d6-garland-theme-batch-processing.html" />
<link rel="alternate" type="application/rss+xml" title="Drupal Dork RSS" href="../rss.xml" />
  <title>D6: Garland Theme for Batch Processing | Drupal Dork</title>
  <link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_pbm0lsQQJ7A7WCCIMgxLho6mI_kBNgznNUWmTWcnfoE.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_VPGZk7E9DmTpTZ-olsKmvUbPc-V3DOyRouMVA8jM4Jg.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_Wu8npAzy16WmnnnWKxpexfgsAryolGGaX6yO3GWA5bU.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_DA76D3kkHaT_VUm3Aj1Txz0yCM9z9qrYjWlPOR-gAwk.css" media="all" />
<link type="text/css" rel="stylesheet" href="../sites/default/files/css/css_2THG1eGiBIizsWFeexsNe1iDifJ00QRS9uSd03rY9co.css" media="print" />

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="http://drupaldork.com/themes/bartik/css/ie.css?mrsb48" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="http://drupaldork.com/themes/bartik/css/ie6.css?mrsb48" media="all" />
<![endif]-->
  <script type="text/javascript" src="../sites/default/files/js/js_xAPl0qIk9eowy_iS9tNkCWXLUVoat94SQT48UBCFkyQ.js"></script>
<script type="text/javascript" src="../sites/default/files/js/js_lgAAOlplEun7p_8Pb-8dM079wtvnfwLZ0hAK0mH7Dto.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-248277-13"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"brocktik","theme_token":"0GJZHtS4IqB_dZyUd4NorPGbD-r3dXtq1IEk78j8Mro","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/contrib\/google_analytics\/googleanalytics.js":1,"0":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/contrib\/date\/date_api\/date.css":1,"sites\/all\/modules\/contrib\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/contrib\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/views\/css\/views.css":1,"sites\/all\/modules\/contrib\/ctools\/css\/ctools.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"themes\/bartik\/css\/colors.css":1,"themes\/bartik\/css\/print.css":1,"themes\/bartik\/css\/ie.css":1,"themes\/bartik\/css\/ie6.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-second page-node page-node- page-node-42 node-type-post" >
  <div id="skip-link">
    <a href="209.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="without-secondary-menu"><div class="section clearfix">

          <a href="../index.html" title="Home" rel="home" id="logo">
        <img src="../sites/all/themes/brocktik/logo.png" alt="Home" />
      </a>
    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="../index.html" title="Home" rel="home"><span>Drupal Dork</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Drupal: pretty great.          </div>
        
      </div> <!-- /#name-and-slogan -->
    
      <div class="region region-header">
  </div>

          <div id="main-menu" class="navigation">
        <h2 class="element-invisible">Main menu</h2><ul id="main-menu-links" class="links clearfix"><li class="menu-534 first"><a href="../index.html" title="">Home</a></li>
<li class="menu-533"><a href="../about.html" title="About">About</a></li>
<li class="menu-122"><a href="../archive.html">Archive</a></li>
<li class="menu-118 last"><a href="../contact.html" title="">Contact</a></li>
</ul>      </div> <!-- /#main-menu -->
    
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

          <div id="breadcrumb"><h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="../index.html">Home</a></div></div>
    
    
    <div id="content" class="column instapaper_body"><div class="messages warning">Heads up: this site is out of date. What you see here is simply a snapshot of DrupalDork.com from September 18, 2013, when I shut it down.</div><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          D6: Garland Theme for Batch Processing        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-42" class="node node-post node-promoted node-full clearfix" about="/2012/03/d6-garland-theme-batch-processing" typeof="sioc:Item foaf:Document">

      
      <div class="meta submitted">
            <span property="dc:date dc:created" content="2012-03-30T19:25:51-04:00" datatype="xsd:dateTime" rel="sioc:has_creator">Submitted by <span class="username" xml:lang="" about="/users/brock" typeof="sioc:UserAccount" property="foaf:name" datatype="">Brock</span> on Fri 30 Mar 2012, 7:25 pm</span>    </div>
  
  <div class="content clearfix">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>There's a <a href="http://drupal.org/node/539022">long-running bug in the Drupal issue queue</a> about a bug that I had to work around this week: when using the <a href="http://drupal.org/node/180528">Batch API</a>, your site theme will only be used for the first page. As the page reloads to show the progress of the job, the ugly, default Garland theme is used (well, that's not entirely true: it's actually Minnelli, but looks like Garland).</p>
<p>In most cases, this isn't a big deal: during a site install or when running update.php, it doesn't really matter what theme the admins see. In one client's case, though, we're using the Batch API to show progress of a multi-part donation that may take some time to process. In that case, you don't want regular site visitors seeing Minnelli: it's a jarring transition away from the site theme, and to anyone who isn't a seasoned Drupal user, it probably looks like something broke.</p>
<p>It took me a bit to find the solution to this problem. The issue I mentioned above is now being fixed for Drupal 8, but the menu system has changed enough that the patches posted there don't work with the older version of Drupal that I'm working with. After some digging, I found the solution: you need to override your maintenance theme.</p>
<ol><li>Override the <code>maintenance_theme</code> variable in <code>settings.php</code>. Any variable that's retrieved using <a href="http://api.drupal.org/api/drupal/includes%21bootstrap.inc/function/variable_get/6"><code>variable_get()</code></a> can be completely overridden by setting it in the <code>$conf</code>array. In this case, you just need to add one line to <code>settings.php</code>:
<p>    <code>$conf['maintenance_theme'] = 'my_site_theme';</code></p>
<p>  Naturally, you'll need to replace <code>my_site_theme</code> with the name of your site theme.</p></li>
<li>Copy <code>maintenance-page.tpl.php</code> into your theme directory. Go into the <code>modules/system</code> directory at the Drupal root, find <code>maintenance-page.tpl.php</code>, and copy it into your theme directory—the one that matches the name you set for <code>$conf['maintenance_theme']</code>, that is.</li>
</ol><p>Your site theme will now be used for every step in batch processing. It's important to also note that this theme will also be used if you actually do put the site in maintenance mode, since that's what you're overriding. Minnelli will still be used for update.php, though.</p>
<p>I'm not entirely certain that the second step is necessary, since a quick test shows that the batch process still used the site theme even when I removed <code>maintenance-page.tpl.php</code> from the theme directory. It may only be needed for actual maintenance mode, but the comments in <code>settings.php</code> say to copy it, so I copied it.</p>
</div></div></div><div class="field field-name-taxonomy-vocabulary-1 field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Category: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../category/how.html" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">How-To</a></li></ul></div><div class="field field-name-field-drupal-ver field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Drupal Version: </h3><ul class="links"><li class="taxonomy-term-reference-0"><a href="../drupal_version/drupal-6.html" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">Drupal 6</a></li></ul></div>  </div>

  
  <div id="comments" class="comment-wrapper">
          <h2 class="title">Comments</h2>
      
  <a id="comment-209"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/209#comment-209" typeof="sioc:Post sioct:Comment">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span rel="sioc:has_creator"><span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">yakoub abaya (not verified)</span></span>      </p>
      <p class="comment-time">
        <span property="dc:date dc:created" content="2012-03-31T02:24:54-04:00" datatype="xsd:dateTime">Sat 31 Mar 2012, 2:24 am</span>      </p>
      <p class="comment-permalink">
        <a href="209.html#comment-209" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
        <h3 property="dc:title" datatype=""><a href="209.html#comment-209" class="permalink" rel="bookmark">no such problem</a></h3>
    
    <div class="content">
      <span rel="sioc:reply_of" resource="/2012/03/d6-garland-theme-batch-processing" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>i don't know what you are talking about, i used batch api in drupal6 to export data into excel file<br />
and present it as file download and the site doesn't switch theme while processing ..</p>
</div></div></div>          </div> <!-- /.content -->

      </div> <!-- /.comment-text -->
</div>
<a id="comment-215"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/215#comment-215" typeof="sioc:Post sioct:Comment">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span rel="sioc:has_creator"><span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">btopro (not verified)</span></span>      </p>
      <p class="comment-time">
        <span property="dc:date dc:created" content="2012-04-02T08:53:58-04:00" datatype="xsd:dateTime">Mon 2 Apr 2012, 8:53 am</span>      </p>
      <p class="comment-permalink">
        <a href="215.html#comment-215" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
        <h3 property="dc:title" datatype=""><a href="215.html#comment-215" class="permalink" rel="bookmark">Hmm, neat trick. I was able</a></h3>
    
    <div class="content">
      <span rel="sioc:reply_of" resource="/2012/03/d6-garland-theme-batch-processing" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hmm, neat trick. I was able to pull this off in D6 by using context to set the theme.  It was reeeaaallly driving me nuts because my users can trigger batch jobs often and it looked really bad.</p>
</div></div></div>          </div> <!-- /.content -->

      </div> <!-- /.comment-text -->
</div>
<a id="comment-729"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/729#comment-729" typeof="sioc:Post sioct:Comment">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span rel="sioc:has_creator"><span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">apanag (not verified)</span></span>      </p>
      <p class="comment-time">
        <span property="dc:date dc:created" content="2012-08-10T06:46:24-04:00" datatype="xsd:dateTime">Fri 10 Aug 2012, 6:46 am</span>      </p>
      <p class="comment-permalink">
        <a href="729.html#comment-729" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
        <h3 property="dc:title" datatype=""><a href="729.html#comment-729" class="permalink" rel="bookmark">Nice!</a></h3>
    
    <div class="content">
      <span rel="sioc:reply_of" resource="/2012/03/d6-garland-theme-batch-processing" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Thanks for the tip.</p>
</div></div></div>          </div> <!-- /.content -->

      </div> <!-- /.comment-text -->
</div>
<a id="comment-734"></a>
<div class="comment comment-by-anonymous clearfix" about="/comment/734#comment-734" typeof="sioc:Post sioct:Comment">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span rel="sioc:has_creator"><span class="username" xml:lang="" typeof="sioc:UserAccount" property="foaf:name" datatype="">Tom (not verified)</span></span>      </p>
      <p class="comment-time">
        <span property="dc:date dc:created" content="2012-08-27T16:20:47-04:00" datatype="xsd:dateTime">Mon 27 Aug 2012, 4:20 pm</span>      </p>
      <p class="comment-permalink">
        <a href="734.html#comment-734" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
        <h3 property="dc:title" datatype=""><a href="734.html#comment-734" class="permalink" rel="bookmark">Nice!</a></h3>
    
    <div class="content">
      <span rel="sioc:reply_of" resource="/2012/03/d6-garland-theme-batch-processing" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Thanks!</p>
</div></div></div>          </div> <!-- /.content -->

      </div> <!-- /.comment-text -->
</div>

  </div>

</div>
  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

          <div id="sidebar-second" class="column sidebar"><div class="section">
          <div class="region region-sidebar-second">
    <div id="block-block-1" class="block block-block">

    <h2>My Main Site</h2>
  
  <div class="content">
    <p><a href="http://brockboland.com/">BrockBoland.com</a></p>
  </div>
</div>
<div id="block-block-8" class="block block-block">

    <h2>Hi!</h2>
  
  <div class="content">
    <p>I'm Brock Boland, and I like Drupal a little more than is socially acceptable.<br /></p><center><a href="../about.html"><img src="../sites/default/files/2012/05/smile-fence-150.jpg" width="150" height="150" alt="Bald Brock" title="Bald Brock" /></a></center>
  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-second -->
    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
          <div id="footer" class="clearfix">
          <div class="region region-footer">
    <div id="block-block-5" class="block block-block">

    
  <div class="content">
    <p>Content © 2009 - 2012 Brock Boland. Powered by <a href="http://drupal.org/">Drupal</a> because it's great. <a href="http://www.drupal.org" target="_blank">Drupal</a> is a registered trademark of <a href="http://buytaert.net/" target="_blank">Dries Buytaert</a>. The <a href="http://drupal.org/druplicon" target="_blank">Druplicon image</a> is licensed under the <a href="http://drupal.org/licensing/faq" target="_blank">GPL License</a>.</p>
  </div>
</div>
  </div>
      </div> <!-- /#footer -->
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
